[["Kleber", "https://plus.google.com/114937925666302803969", "gp-1517626862203", "<p>The &lt;amp-list&gt; of comments is height=\"500\", which means a big empty block of whitespace at the foot of the post.  (Well, I suppose it won't be empty once I post this, but still.)  That doesn't seem great...</p>", 1517626862], ["Jan-Willem", "https://plus.google.com/100580955183019057735", "gp-1517678124956", "<p>Hmm, the first page's WPT waterfalls look bad for what's basically a text site (and thus should be nearly-optimal).  It looks like the big problem is AMP JS load time!  I wonder what the cache rate for these files is (given that your drawing them from cdn.ampproject... like All True Scotsmen).</p>", 1517678124], ["Jeff&nbsp;Kaufman", "https://plus.google.com/103013777355236494008", "gp-1517720104072", "<p>@<a href=\"https://plus.google.com/114937925666302803969\">Kleber</a>\n I don't see a good solution to that.  The AMP runtime needs to know the height for layout, but the page doesn't know how many comments there will be until it finishes the XHR.  (The page is static; the comments are the only dynamic part.)  If I set a low height then on posts short enough where the comment section was immediately on screen the comments wouldn't be able to show up automatically.\n<br>\n<br>\nI believe &lt;amp-list&gt; auto-expands if it gets more than fits and it's off screen at the time.  I think maybe what I want here is something that has the same behavior but also auto-shrinks if it ends up receiving less?</p>", 1517720104], ["Jeff&nbsp;Kaufman", "https://plus.google.com/103013777355236494008", "gp-1517720376058", "<p>@<a href=\"https://plus.google.com/100580955183019057735\">Jan-Willem</a>\n With WPT things will never be in cache, so I do expect things to look a bit better in practice.  But yes: I'm taking a site that does everything (except comments) declaratively and sticking a blocking script load in the critical path.\n<br>\n<br>\n(For users on Safari there's no cross-site cache sharing, so loading the JS from a canonical source isn't helping there.)</p>", 1517720376], ["Izzy", "https://plus.google.com/117530712117219891863", "gp-1517847887382", "<p>Interaction with JavaScript blocking that you may or may not care about:\n<br>\n<br>\nWhen I get the AMP version of a page in a browser that's blocking \n<a href=\"http://ampproject.org\">http://ampproject.org</a>\n javascript for your domain, but not blocking javascript so blanketly that the browser activates &lt;noscript&gt; tags, your inline CSS makes the post content not appear for 8 seconds.\n<br>\n<br>\nThe changes to images for AMP also, reasonably, make the images not show up in the AMP version in this browser configuration.  They still show up in the HTML version.\n<br>\n<br>\n(This is using uBlock Origin's advanced script blocking features. I'm happy to whitelist your domain; I'm commenting in case these effects matter to you.)</p>", 1517847887], ["Jeff&nbsp;Kaufman", "https://plus.google.com/103013777355236494008", "gp-1517849685804", "<p>@<a href=\"https://plus.google.com/117530712117219891863\">Izzy</a>\n It sounds like you're saying you're blocking the \n<a href=\"http://ampproject.org\">http://ampproject.org</a>\n javascript, but you're not executing the contents of noscript tags?  I would expect that to break a lot of sites!</p>", 1517849685], ["Jeff&nbsp;Kaufman", "https://plus.google.com/103013777355236494008", "gp-1517856368777", "<p>@<a href=\"https://plus.google.com/117530712117219891863\">Izzy</a>\n I'd also expect this would be a problem for you on any amp page, and not just mine? Or is it just my site?</p>", 1517856368], ["Jeff&nbsp;Kaufman", "https://plus.google.com/103013777355236494008", "gp-1517856545554", "<p>(What sorts of things are you trying to avoid by blocking JavaScript? Depending on your goals and how much you trust the AMP review process it may be that AMP JS is something you'd want to allow globally?)</p>", 1517856545], ["Izzy", "https://plus.google.com/117530712117219891863", "gp-1518584634452", "<p>I see a similar effect on \n<a href=\"https://ampbyexample.com/\">https://ampbyexample.com/</a>\n , which is a site that uses AMP.  In the last month of web browsing I haven't naturally run into any AMP sites like this besides yours (on Chromebook). So I don't think I'd see much difference between whitelisting your site and AMP in general.  (I do see AMP sites on mobile regularly.)\n<br>\n<br>\nThe JavaScript-blocking was a \"hey, why don't I turn this on while people work out the Meltdown/Spectre situation\".  It turns out that some websites work better with javascript off than on, so I'm happy for now. Though google properties tend to depend on javascript even where it makes google an outlier (blog platforms).\n<br>\n<br>\nAnyway yes you are correct that lots of sites are only full-featured if they have their Javascript.\n<br>\n<br>\nI think there's some obscure reason why a selective javascript blocking tool doesn't activate &lt;noscript&gt;. My sense is the lack of &lt;noscript&gt; activation doesn't make much difference on most websites, because most sites don't test without scripts anyway. In random personal code, instead of &lt;noscript&gt; I've used a &lt;script&gt; that changes a CSS class on the &lt;html&gt; element, because it's a moderately more accurate proxy for whether scripts are working than &lt;noscript&gt; is. Of course, you are as aware as I am of some reasons that extra &lt;script&gt;s are inefficient, so :)</p>", 1518584634], ["Jeff&nbsp;Kaufman", "https://plus.google.com/103013777355236494008", "gp-1518642875174", "<p>@<a href=\"https://plus.google.com/117530712117219891863\">Izzy</a>\n I think what's happening is that AMP is currently pretty rare on desktop.  Many sites only serve AMP versions for mobile, and with others Google discovers the AMP version of a page via link rel=amphtml and then uses that link in search results for people on mobile devices.  This may change, though, since AMP is mostly not mobile-specific.</p>", 1518642875]]